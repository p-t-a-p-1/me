---
import SearchBox from "../components/SearchBox.astro";
import Layout from "../layouts/Layout.astro";

// URL ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‹ã‚‰åˆæœŸæ¤œç´¢ã‚¯ã‚¨ãƒªã‚’å–å¾—
const url = Astro.url;
const initialQuery = url.searchParams.get("q") || "";
const initialCategory = url.searchParams.get("category") || "";
const initialTag = url.searchParams.get("tag") || "";
const initialDifficulty = url.searchParams.get("difficulty") || "";

// ãƒšãƒ¼ã‚¸ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿
const title = initialQuery ? `"${initialQuery}" ã®æ¤œç´¢çµæœ` : "è¨˜äº‹æ¤œç´¢";

const description = initialQuery
	? `"${initialQuery}" ã«é–¢ã™ã‚‹è¨˜äº‹ã‚’æ¤œç´¢ã—ãŸçµæœã§ã™ã€‚`
	: "ãƒ–ãƒ­ã‚°è¨˜äº‹ã‚’æ¤œç´¢ã§ãã¾ã™ã€‚ã‚¿ã‚¤ãƒˆãƒ«ã€èª¬æ˜ã€ã‚¿ã‚°ã€ã‚«ãƒ†ã‚´ãƒªã‹ã‚‰è¨˜äº‹ã‚’è¦‹ã¤ã‘ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚";

const pageType = "website";
---

<Layout
	title={title}
	description={description}
	pageType={pageType}
	keywords={["æ¤œç´¢", "ãƒ–ãƒ­ã‚°", "è¨˜äº‹", "ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°", "æŠ€è¡“"]}
>
	<main class="search-page">
		<div class="container">
			<!-- ãƒšãƒ¼ã‚¸ãƒ˜ãƒƒãƒ€ãƒ¼ -->
			<header class="page-header">
				<h1 class="page-title">ğŸ” è¨˜äº‹æ¤œç´¢</h1>
				<p class="page-description">
					æŠ€è¡“è¨˜äº‹ã‚’ç°¡å˜ã«æ¤œç´¢ã§ãã¾ã™ã€‚ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã€ã‚«ãƒ†ã‚´ãƒªã€ã‚¿ã‚°ã€é›£æ˜“åº¦ã§çµã‚Šè¾¼ã¿ãŒå¯èƒ½ã§ã™ã€‚
				</p>
			</header>

			<!-- æ¤œç´¢ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ -->
			<section class="search-section">
				<SearchBox
					initialQuery={initialQuery}
					showFilters={true}
					className="main-search"
				/>
			</section>

			<!-- æ¤œç´¢ã®ãƒ’ãƒ³ãƒˆ -->
			<section class="search-tips">
				<h2 class="tips-title">æ¤œç´¢ã®ãƒ’ãƒ³ãƒˆ</h2>
				<div class="tips-grid">
					<div class="tip-item">
						<h3>ğŸ¯ ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰æ¤œç´¢</h3>
						<p>
							è¨˜äº‹ã®ã‚¿ã‚¤ãƒˆãƒ«ã€èª¬æ˜ã€ã‚¿ã‚°ã‹ã‚‰æ¤œç´¢ã§ãã¾ã™ã€‚è¤‡æ•°ã®ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›ã™ã‚‹ã¨ã€ã‚ˆã‚Šç²¾å¯†ãªæ¤œç´¢ãŒå¯èƒ½ã§ã™ã€‚
						</p>
					</div>

					<div class="tip-item">
						<h3>ğŸ“‚ ã‚«ãƒ†ã‚´ãƒªãƒ•ã‚£ãƒ«ã‚¿ãƒ¼</h3>
						<p>
							Frontendã€Backendã€DevOpsã€Generalãªã©ã€æŠ€è¡“åˆ†é‡åˆ¥ã«è¨˜äº‹ã‚’çµã‚Šè¾¼ã‚ã¾ã™ã€‚
						</p>
					</div>

					<div class="tip-item">
						<h3>ğŸ“Š é›£æ˜“åº¦ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼</h3>
						<p>
							åˆç´šãƒ»ä¸­ç´šãƒ»ä¸Šç´šã§è¨˜äº‹ã®é›£æ˜“åº¦ã‚’é¸æŠã§ãã¾ã™ã€‚å­¦ç¿’ãƒ¬ãƒ™ãƒ«ã«åˆã‚ã›ã¦ãŠé¸ã³ãã ã•ã„ã€‚
						</p>
					</div>

					<div class="tip-item">
						<h3>ğŸ·ï¸ ã‚¿ã‚°æ¤œç´¢</h3>
						<p>
							Reactã€Vueã€Node.jsã€TypeScriptãªã©ã€å…·ä½“çš„ãªæŠ€è¡“ã‚¿ã‚°ã§æ¤œç´¢ã§ãã¾ã™ã€‚
						</p>
					</div>
				</div>
			</section>

			<!-- äººæ°—ã®ã‚«ãƒ†ã‚´ãƒª -->
			<section class="popular-categories">
				<h2 class="section-title">äººæ°—ã®ã‚«ãƒ†ã‚´ãƒª</h2>
				<div class="category-links">
					<a href="/search?category=frontend" class="category-link frontend">
						ğŸ¨ Frontend
					</a>
					<a href="/search?category=backend" class="category-link backend">
						âš™ï¸ Backend
					</a>
					<a href="/search?category=devops" class="category-link devops">
						ğŸš€ DevOps
					</a>
					<a href="/search?category=general" class="category-link general">
						ğŸ“š General
					</a>
					<a href="/search?category=mobile" class="category-link mobile">
						ğŸ“± Mobile
					</a>
					<a href="/search?category=ai" class="category-link ai"> ğŸ¤– AI/ML </a>
				</div>
			</section>

			<!-- äººæ°—ã®ã‚¿ã‚° -->
			<section class="popular-tags">
				<h2 class="section-title">äººæ°—ã®ã‚¿ã‚°</h2>
				<div class="tag-cloud">
					<a href="/search?tag=React" class="tag-link size-lg">React</a>
					<a href="/search?tag=Vue" class="tag-link size-md">Vue</a>
					<a href="/search?tag=TypeScript" class="tag-link size-lg"
						>TypeScript</a
					>
					<a href="/search?tag=Node.js" class="tag-link size-md">Node.js</a>
					<a href="/search?tag=JavaScript" class="tag-link size-xl"
						>JavaScript</a
					>
					<a href="/search?tag=CSS" class="tag-link size-md">CSS</a>
					<a href="/search?tag=HTML" class="tag-link size-sm">HTML</a>
					<a href="/search?tag=Next.js" class="tag-link size-lg">Next.js</a>
					<a href="/search?tag=Nuxt" class="tag-link size-md">Nuxt</a>
					<a href="/search?tag=Python" class="tag-link size-md">Python</a>
					<a href="/search?tag=Docker" class="tag-link size-sm">Docker</a>
					<a href="/search?tag=AWS" class="tag-link size-sm">AWS</a>
				</div>
			</section>
		</div>
	</main>
</Layout>

<style>
	.search-page {
		min-height: 100vh;
		padding: 2rem 0;
		background: white;
	}

	.container {
		max-width: 1200px;
		margin: 0 auto;
		padding: 0 1rem;
	}

	/* ãƒšãƒ¼ã‚¸ãƒ˜ãƒƒãƒ€ãƒ¼ */
	.page-header {
		text-align: center;
		margin-bottom: 3rem;
	}

	.page-title {
		font-size: clamp(2rem, 5vw, 3rem);
		font-weight: 700;
		color: #262626;
		margin-bottom: 1rem;
		font-family: "Noto Sans JP", sans-serif;
	}

	.page-description {
		font-size: 1.125rem;
		color: #64748b;
		max-width: 600px;
		margin: 0 auto;
		line-height: 1.6;
	}

	/* æ¤œç´¢ã‚»ã‚¯ã‚·ãƒ§ãƒ³ */
	.search-section {
		margin-bottom: 4rem;
		padding: 2rem;
		background: white;
		border: 1px solid #262626;
	}

	/* æ¤œç´¢ã®ãƒ’ãƒ³ãƒˆ */
	.search-tips {
		margin-bottom: 4rem;
	}

	.tips-title {
		font-size: 1.5rem;
		font-weight: 600;
		color: #262626;
		margin-bottom: 1.5rem;
		text-align: center;
		font-family: "Noto Sans JP", sans-serif;
	}

	.tips-grid {
		display: grid;
		grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
		gap: 1.5rem;
	}

	.tip-item {
		padding: 1.5rem;
		background: white;
		border: 1px solid #e5e5e5;
		transition: transform 0.2s ease;
	}

	.tip-item:hover {
		transform: translateY(-2px);
	}

	.tip-item h3 {
		font-size: 1.125rem;
		font-weight: 600;
		color: #262626;
		margin-bottom: 0.75rem;
		font-family: "Noto Sans JP", sans-serif;
	}

	.tip-item p {
		color: #64748b;
		line-height: 1.6;
	}

	/* äººæ°—ã®ã‚«ãƒ†ã‚´ãƒª */
	.popular-categories {
		margin-bottom: 4rem;
	}

	.section-title {
		font-size: 1.5rem;
		font-weight: 600;
		color: #262626;
		margin-bottom: 1.5rem;
		text-align: center;
		font-family: "Noto Sans JP", sans-serif;
	}

	.category-links {
		display: grid;
		grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
		gap: 1rem;
	}

	.category-link {
		display: flex;
		align-items: center;
		justify-content: center;
		padding: 1rem 1.5rem;
		background: white;
		border-radius: 12px;
		text-decoration: none;
		color: #1e293b;
		font-weight: 500;
		box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
		transition: all 0.2s ease;
	}

	.category-link:hover {
		transform: translateY(-2px);
		box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
	}

	.category-link.frontend:hover {
		background: linear-gradient(135deg, #3b82f6, #1d4ed8);
		color: white;
	}

	.category-link.backend:hover {
		background: linear-gradient(135deg, #10b981, #047857);
		color: white;
	}

	.category-link.devops:hover {
		background: linear-gradient(135deg, #f59e0b, #d97706);
		color: white;
	}

	.category-link.general:hover {
		background: linear-gradient(135deg, #8b5cf6, #7c3aed);
		color: white;
	}

	.category-link.mobile:hover {
		background: linear-gradient(135deg, #ec4899, #be185d);
		color: white;
	}

	.category-link.ai:hover {
		background: linear-gradient(135deg, #6366f1, #4f46e5);
		color: white;
	}

	/* äººæ°—ã®ã‚¿ã‚° */
	.popular-tags {
		margin-bottom: 2rem;
	}

	.tag-cloud {
		display: flex;
		flex-wrap: wrap;
		gap: 0.75rem;
		justify-content: center;
	}

	.tag-link {
		padding: 0.5rem 1rem;
		background: white;
		border: 2px solid #e2e8f0;
		border-radius: 25px;
		text-decoration: none;
		color: #475569;
		font-weight: 500;
		transition: all 0.2s ease;
	}

	.tag-link:hover {
		border-color: #3b82f6;
		color: #3b82f6;
		transform: scale(1.05);
	}

	.tag-link.size-xl {
		font-size: 1.125rem;
		padding: 0.75rem 1.5rem;
	}

	.tag-link.size-lg {
		font-size: 1rem;
		padding: 0.625rem 1.25rem;
	}

	.tag-link.size-md {
		font-size: 0.875rem;
		padding: 0.5rem 1rem;
	}

	.tag-link.size-sm {
		font-size: 0.75rem;
		padding: 0.375rem 0.75rem;
	}

	/* ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ– */
	@media (max-width: 768px) {
		.search-page {
			padding: 1rem 0;
		}

		.search-section {
			margin: 0 -1rem 3rem;
			border-radius: 0;
		}

		.tips-grid {
			grid-template-columns: 1fr;
		}

		.category-links {
			grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
		}

		.tag-cloud {
			justify-content: flex-start;
		}
	}
</style>

<script>
	// URL ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã«åŸºã¥ã„ã¦åˆæœŸãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã‚’è¨­å®š
	document.addEventListener("DOMContentLoaded", () => {
		const urlParams = new URLSearchParams(window.location.search);

		// ã‚«ãƒ†ã‚´ãƒªãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã‚’è¨­å®š
		const category = urlParams.get("category");
		if (category) {
			const categoryFilter = document.getElementById(
				"category-filter"
			) as HTMLSelectElement;
			if (categoryFilter) {
				categoryFilter.value = category;
				// ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼å¤‰æ›´ã‚¤ãƒ™ãƒ³ãƒˆã‚’ç™ºç«
				categoryFilter.dispatchEvent(new Event("change"));
			}
		}

		// ã‚¿ã‚°ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã‚’è¨­å®š
		const tag = urlParams.get("tag");
		if (tag) {
			const tagFilter = document.getElementById(
				"tag-filter"
			) as HTMLSelectElement;
			if (tagFilter) {
				// ã‚¿ã‚°ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã«ã‚ªãƒ—ã‚·ãƒ§ãƒ³ãŒèª­ã¿è¾¼ã¾ã‚Œã‚‹ã¾ã§å¾…æ©Ÿ
				const checkTagFilter = () => {
					if (tagFilter.options.length > 1) {
						tagFilter.value = tag;
						tagFilter.dispatchEvent(new Event("change"));
					} else {
						setTimeout(checkTagFilter, 100);
					}
				};
				checkTagFilter();
			}
		}

		// é›£æ˜“åº¦ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã‚’è¨­å®š
		const difficulty = urlParams.get("difficulty");
		if (difficulty) {
			const difficultyFilter = document.getElementById(
				"difficulty-filter"
			) as HTMLSelectElement;
			if (difficultyFilter) {
				difficultyFilter.value = difficulty;
				difficultyFilter.dispatchEvent(new Event("change"));
			}
		}
	});
</script>
